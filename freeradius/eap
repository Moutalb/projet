 eap {
    default_eap_type = peap
    timer_expire = 60
    ignore_unknown_eap_types = no
    cisco_accounting_username_bug = no
    max_sessions = ${max_requests}

    # Configuration TLS commune
    tls-config tls-common {
        private_key_file = /etc/freeradius/certs/ldaps.key
        certificate_file = /etc/freeradius/certs/ldaps.crt
        ca_file = /etc/freeradius/certs/ProjetRootCA.pem
        random_file = /dev/urandom
    }

    # Définition de la section tls utilisée par PEAP et EAP-TLS
    tls {
        tls = tls-common
    }

    # Configuration PEAP
    peap {
        default_eap_type = mschapv2
        copy_request_to_tunnel = no
        use_tunneled_reply = no
        proxy_tunneled_request_as_eap = yes
        virtual_server = "inner-tunnel"
        soh = no
        require_client_cert = no
        tls = tls-common
    }

    mschapv2 {
        # Configuration spécifique MSCHAPv2 si besoin
    }
}
